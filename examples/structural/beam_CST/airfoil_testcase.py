import matplotlib.pyplot as plt
import numpy as np
import pickle

from aeropy.structural.beam import beam_chen
from aeropy.structural.stable_solution import properties, loads
from aeropy.geometry.parametric import CoordinateSystem
from aeropy.CST_2D import calculate_c_baseline
from aeropy.geometry.airfoil import create_x, rotate

import cProfile
import pstats


def format_input(input, g=None, g_p=None):
    # def residual(deltaz):
    #     g.D[-1] = deltaz[0]
    #     g.internal_variables(target_length)
    #     rho_p = (1/g_p.chord)*dd_p/(1+d_p**2)**(3/2)
    #     dd = (2*n*g.D[-3] - 2*(g.N1+n)*g.D[-2])
    #     d = -g.D[-2] + g.D[-1]
    #     rho = (1/g.chord)*dd/(1+d**2)**(3/2)
    #     g.radius_curvature(np.array([g.chord]))
    #     rho_new = g_p.rho[0]
    #     print(deltaz, rho, rho_new, rho_p, rho_p_new)
    #     return(abs(rho_new-rho_p_new))

    # print('D before', g.D)
    g.D[:-1] = input
    error = 9999
    n = g.n - 2
    dd_p = (2*n*g_p.D[-3] - 2*(g_p.N1+n)*g_p.D[-2])
    d_p = -g_p.D[-2] + g_p.D[-1]
    rho_p = (1/g_p.chord)*dd_p/(1+d_p**2)**(3/2)
    target_length = g_p.arclength(g_p.chord)[0]
    # rho_p = dd_p/(1+d_p**2)**(3/2)
    # g.D[-1] = fsolve(residual, g.D[-1])[0]
    # BREAK
    # BREAK

    print('target', target_length)

    while error > 1e-4:
        before = g.D[-1]
        C = rho_p*g.chord
        dd = (2*n*g.D[-3] - 2*(g.N1+n)*g.D[-2])
        d = -g.D[-2] + g.D[-1]

        if C > 0:
            deltaz = np.sqrt((dd/C)**(2/3)-1) + g.D[-2]
        elif C < 0:
            deltaz = -np.sqrt((dd/C)**(2/3)-1) + g.D[-2]
        if not np.isnan(deltaz):
            g.D[-1] = deltaz
        else:
            break

        d = -g.D[-2] + g.D[-1]
        rho = (1/g.chord)*dd/(1+d**2)**(3/2)
        print('D after', g.D)
        print('terms', np.sqrt((dd/C)**(2/3)-1), g.D[-2])
        print('C', C, rho_p, g.chord, g_p.chord)
        print('dd', d, d_p, dd, dd_p)
        print('before', before)
        print('rho', rho, rho_p)

        g.internal_variables(target_length)
        after = g.D[-1]
        print('after', after)
        error = abs(after - before)
        print('deltaxi', g.D[-1], 'error', error)
        # BREAK
    return g.D


# abaqus_x = [0, 0.0046626413, 0.018402023, 0.048702486, 0.087927498, 0.12745513,
#             0.16709827, 0.20679522, 0.24651785, 0.28625035, 0.3259826,
#             0.36570814, 0.40542319, 0.44512612, 0.48481697, 0.52449685,
#             0.5641672, 0.60382956, 0.64348471, 0.68313259, 0.72277194,
#             0.76240051, 0.80201453, 0.84160942, 0.88117975, 0.92072034,
#             0.96022779, 0.99970293]
# abaqus_y = [0, 0.0080771167, 0.015637144, 0.024132574, 0.030406451,
#             0.034420185, 0.037082944, 0.038775206, 0.039692041, 0.039953224,
#             0.039647505, 0.038851682, 0.037638135, 0.036076538, 0.034232546,
#             0.032165118, 0.029923303, 0.027543247, 0.025045833, 0.022435322,
#             0.019699335, 0.016810443, 0.013729585, 0.010411576, 0.0068127746,
#             0.0029010926, -0.0013316774, -0.0058551501]

abaqus_x = [3.9838915e-42, 6.9717338e-05, 0.00025828209, 0.00057728315, 0.0010066391, 0.0015256653, 0.0021160613, 0.0027626404, 0.0034542182, 0.0041813487, 0.0049368078, 0.0057155504, 0.0065151569, 0.0073340582, 0.008169503, 0.0090204421, 0.0098850764, 0.010762303, 0.011649491, 0.012545014, 0.013447377, 0.014355262, 0.015267923, 0.016185069, 0.01710644, 0.01803178, 0.018960847, 0.019893415, 0.020829273, 0.021768225, 0.022710087, 0.02365539, 0.024602577, 0.025552191, 0.026504075, 0.027458081, 0.028414071, 0.0293719, 0.030331446, 0.031292573, 0.032255705, 0.03321958, 0.034184337, 0.035150036, 0.036116756, 0.037084535, 0.038053416, 0.039023418, 0.03999453, 0.040966734, 0.041939989, 0.042914223, 0.043889374, 0.04486537, 0.045842133, 0.046819612, 0.047797747, 0.048776492, 0.049755819, 0.050735686, 0.051716067, 0.052696936, 0.0536783, 0.054660134, 0.055642437, 0.056625199, 0.057608407, 0.058592055, 0.059576128, 0.060560614, 0.061545499, 0.062530771, 0.063516416, 0.064502403, 0.065488748, 0.066475421, 0.0674624, 0.068449691, 0.06943728, 0.070425138, 0.071413286, 0.072401702, 0.073390372, 0.074379288, 0.075368464, 0.076357871, 0.077347502, 0.078337371, 0.079327457, 0.080317751, 0.081308261, 0.082298972, 0.083289877, 0.084280975, 0.085272253, 0.086263724, 0.087255366, 0.088247173, 0.089239158, 0.090231292, 0.09122359, 0.092216045, 0.093208648, 0.094201401, 0.095194295, 0.096187323, 0.097180493, 0.098173797, 0.099167235, 0.10016079, 0.10115448, 0.10214828, 0.1031422, 0.10413624, 0.10513039, 0.10612465, 0.10711902, 0.10811349, 0.10910807, 0.11010274, 0.11109752, 0.11209239, 0.11308736, 0.11408241, 0.11507756, 0.1160728, 0.11706813, 0.11806353, 0.11905902, 0.1200546, 0.12105025, 0.12204597, 0.12304178, 0.12403765, 0.12503362, 0.12602963, 0.12702572, 0.1280219, 0.12901813, 0.13001442, 0.13101079, 0.13200721, 0.1330037, 0.13400024, 0.13499686, 0.13599353, 0.13699026, 0.13798703, 0.13898388, 0.13998076, 0.14097773, 0.1419747, 0.14297177, 0.14396887, 0.14496602, 0.14596321, 0.14696047, 0.14795776, 0.14895509, 0.14995247, 0.15094991, 0.15194738, 0.15294489, 0.15394245, 0.15494005, 0.1559377, 0.15693536, 0.15793309, 0.15893084, 0.15992865, 0.16092646, 0.16192433, 0.16292225, 0.16392018, 0.16491815, 0.16591616, 0.16691419, 0.16791227, 0.16891038, 0.16990852, 0.17090669, 0.17190489, 0.17290312, 0.17390138, 0.17489965, 0.17589797, 0.17689632, 0.17789468, 0.17889307, 0.17989151, 0.18088995, 0.18188842, 0.18288693, 0.18388546, 0.184884, 0.18588257, 0.18688117, 0.18787979, 0.18887842, 0.18987709, 0.19087577, 0.19187447, 0.19287321, 0.19387196, 0.19487071, 0.19586951, 0.19686832, 0.19786714, 0.19886598, 0.19986483, 0.20086373, 0.20186262, 0.20286153, 0.20386046, 0.20485941, 0.20585838, 0.20685735, 0.20785636, 0.20885536, 0.20985439, 0.21085344, 0.21185249, 0.21285155, 0.21385065, 0.21484974, 0.21584885, 0.21684797, 0.21784712, 0.21884626, 0.21984543, 0.2208446, 0.22184378, 0.22284298, 0.22384219, 0.22484142, 0.22584064, 0.22683989, 0.22783913, 0.22883838, 0.22983766, 0.23083694, 0.23183621, 0.23283553, 0.23383483, 0.23483415, 0.23583347, 0.2368328, 0.23783214, 0.23883149, 0.23983085, 0.24083021, 0.24182957, 0.24282895, 0.24382833, 0.24482772, 0.24582711, 0.24682651, 0.24782594, 0.24882534, 0.24982476, 0.25082418, 0.2518236, 0.25282305, 0.25382251, 0.25482196, 0.25582138, 0.25682083, 0.25782028, 0.25881973, 0.25981921, 0.26081866, 0.26181814, 0.26281762, 0.2638171, 0.26481655, 0.26581606, 0.26681554, 0.26781502, 0.26881453, 0.26981401, 0.27081349, 0.27181301, 0.27281252, 0.273812, 0.27481151, 0.27581099, 0.2768105, 0.27781004, 0.27880952, 0.27980903, 0.28080851, 0.28180805, 0.28280753, 0.28380704, 0.28480655, 0.28580606, 0.28680557, 0.28780505, 0.28880456, 0.28980407, 0.29080358, 0.29180309, 0.29280257, 0.29380208, 0.29480159, 0.29580107, 0.29680058, 0.29780009, 0.29879957, 0.29979905, 0.30079854, 0.30179805, 0.30279753, 0.30379701, 0.30479649, 0.30579597, 0.30679545, 0.30779493, 0.30879438, 0.30979386, 0.31079331, 0.31179279, 0.31279224, 0.31379169, 0.31479114, 0.31579059, 0.31679001, 0.31778947, 0.31878889, 0.31978834, 0.32078776, 0.32178721, 0.32278663, 0.32378602, 0.32478544, 0.32578486, 0.32678428, 0.32778367, 0.32878307, 0.32978249, 0.33078185, 0.33178124, 0.3327806, 0.33377999, 0.33477935, 0.33577871, 0.33677807, 0.33777744, 0.33877677, 0.33977613, 0.34077546, 0.34177479, 0.34277415, 0.34377345, 0.34477279, 0.34577209, 0.34677139, 0.34777069, 0.34876999, 0.34976926, 0.35076854, 0.35176784, 0.35276711, 0.35376635, 0.35476562, 0.35576487, 0.35676411, 0.35776335, 0.35876259, 0.3597618, 0.36076102, 0.36176023, 0.36275944, 0.36375862, 0.36475781, 0.36575702, 0.3667562, 0.36775535, 0.36875454, 0.36975369, 0.37075284, 0.37175199, 0.37275115, 0.37375024, 0.37474939, 0.37574849, 0.37674758, 0.3777467, 0.37874579, 0.37974489, 0.38074395, 0.38174301, 0.38274211, 0.38374117, 0.3847402, 0.38573924, 0.3867383, 0.38773733, 0.38873637, 0.38973534, 0.39073437, 0.39173338, 0.39273235, 0.39373136, 0.39473033, 0.39572927, 0.39672825, 0.39772719, 0.39872614, 0.39972508, 0.40072399, 0.40172291, 0.40272185, 0.40372074, 0.40471965, 0.40571854, 0.40671745, 0.4077163, 0.40871516, 0.40971404, 0.41071287, 0.41171172, 0.41271055, 0.4137094, 0.41470823, 0.41570702, 0.41670585, 0.41770464, 0.41870344, 0.4197022, 0.42070097, 0.42169973, 0.4226985, 0.42369726, 0.424696, 0.42569473, 0.42669344, 0.42769217, 0.42869091, 0.42968959, 0.43068829, 0.431687, 0.43268567, 0.43368432, 0.434683, 0.43568167, 0.43668029, 0.43767896, 0.43867758, 0.43967623, 0.44067484, 0.44167343, 0.44267204, 0.44367063, 0.44466925, 0.4456678, 0.44666636, 0.44766495, 0.4486635, 0.44966203, 0.45066059, 0.45165911, 0.45265764, 0.45365617, 0.45465469, 0.45565319, 0.45665166, 0.45765018, 0.45864865, 0.45964712, 0.46064559, 0.46164402, 0.46264249, 0.46364093, 0.46463937, 0.4656378, 0.46663624, 0.46763462, 0.46863303, 0.46963143, 0.47062984, 0.47162822, 0.4726266, 0.47362494, 0.47462332, 0.47562167, 0.47662005, 0.47761837, 0.47861668, 0.479615, 0.48061335, 0.48161167, 0.48260996, 0.48360828, 0.48460656, 0.48560485, 0.48660311, 0.4876014, 0.48859966, 0.48959789, 0.49059615, 0.4915944, 0.49259266, 0.49359086, 0.49458909, 0.49558732, 0.49658552, 0.49758375, 0.49858192, 0.49958009, 0.50057828, 0.50157648, 0.50257468, 0.50357276, 0.50457096, 0.5055691, 0.50656724, 0.50756544, 0.50856352, 0.50956166, 0.51055974, 0.51155782, 0.51255596, 0.51355404, 0.51455218, 0.51555026, 0.51654834, 0.51754642, 0.5185445, 0.51954252, 0.5205406, 0.52153867, 0.5225367, 0.52353472, 0.52453279, 0.52553082, 0.52652884, 0.5275268, 0.52852482, 0.52952284, 0.5305208, 0.53151882, 0.53251684, 0.5335148, 0.53451276, 0.53551072, 0.53650868, 0.53750664, 0.53850454, 0.5395025, 0.54050046, 0.54149836, 0.54249632, 0.54349428, 0.54449219, 0.54549009, 0.54648799, 0.54748589, 0.54848379, 0.54948169, 0.55047953, 0.55147743, 0.55247533, 0.55347317, 0.55447102, 0.55546892, 0.55646676, 0.5574646, 0.55846244, 0.55946028, 0.56045812, 0.56145591, 0.56245375, 0.56345153, 0.56444943, 0.56544715, 0.56644499, 0.56744277, 0.56844062, 0.5694384, 0.57043612, 0.57143396, 0.57243168, 0.57342947, 0.57442725, 0.57542497, 0.57642269, 0.57742053, 0.57841825, 0.57941598, 0.5804137, 0.58141142, 0.58240914, 0.58340687, 0.58440459, 0.58540225, 0.58639997, 0.58739769, 0.58839542, 0.58939308, 0.5903908, 0.59138846, 0.59238613, 0.59338379, 0.59438145, 0.59537911, 0.59637678, 0.59737444, 0.5983721, 0.59936976, 0.60036737, 0.60136503, 0.60236263, 0.60336024, 0.6043579, 0.6053555, 0.6063531, 0.60735077, 0.60834831, 0.60934591, 0.61034352, 0.61134112, 0.61233866, 0.61333627, 0.61433387, 0.61533147, 0.61632895, 0.61732656, 0.61832416, 0.61932164, 0.62031925, 0.62131673, 0.62231433, 0.62331182, 0.62430936, 0.6253069, 0.62630439, 0.62730199, 0.62829947, 0.62929696, 0.63029444, 0.63129199, 0.63228947, 0.63328695, 0.63428444, 0.63528192, 0.63627946, 0.63727689, 0.63827431, 0.63927186, 0.64026928, 0.6412667, 0.64226413, 0.64326167, 0.6442591, 0.64525652, 0.64625394, 0.64725137, 0.64824879, 0.64924622, 0.65024364, 0.651241, 0.65223843, 0.65323585, 0.65423328, 0.65523064, 0.65622801, 0.65722543, 0.65822279, 0.65922016, 0.66021752, 0.66121489, 0.66221225, 0.66320962, 0.66420692, 0.66520429, 0.66620165, 0.66719896, 0.66819632, 0.66919363, 0.67019093, 0.67118824, 0.67218554, 0.67318285, 0.67418021, 0.67517745, 0.6761747, 0.67717201, 0.67816931, 0.67916656, 0.68016386, 0.68116111, 0.68215841, 0.6831556, 0.6841529, 0.68515015, 0.68614733, 0.68714458, 0.68814176, 0.68913901, 0.69013619, 0.69113344, 0.69213063, 0.69312787, 0.694125, 0.69512224, 0.69611937, 0.69711661, 0.69811374, 0.69911093, 0.70010811, 0.70110524, 0.70210242, 0.70309955, 0.70409662, 0.7050938, 0.70609093, 0.70708799, 0.70808518, 0.70908225, 0.71007937, 0.71107644, 0.7120735, 0.71307063, 0.7140677, 0.71506476, 0.71606183, 0.71705884, 0.7180559, 0.71905291, 0.72004998, 0.72104698, 0.72204399, 0.723041, 0.72403806, 0.72503501, 0.72603202, 0.72702903, 0.72802603, 0.72902298, 0.73001999, 0.73101693, 0.73201382, 0.73301077, 0.73400772, 0.73500466, 0.73600161, 0.7369985, 0.73799539, 0.73899233, 0.73998916, 0.74098611, 0.741983, 0.74297982, 0.74397671, 0.74497348, 0.74597037, 0.74696726, 0.74796402, 0.74896091, 0.74995768, 0.75095451, 0.75195128, 0.75294805, 0.75394487, 0.75494158, 0.75593841, 0.75693512, 0.75793183, 0.7589286, 0.75992537, 0.76092201, 0.76191872, 0.76291543, 0.76391214, 0.76490885, 0.7659055, 0.76690215, 0.7678988, 0.76889545, 0.76989204, 0.77088869, 0.77188528, 0.77288193, 0.77387851, 0.7748751, 0.77587163, 0.77686822, 0.77786481, 0.77886134, 0.77985787, 0.78085434, 0.78185087, 0.7828474, 0.78384393, 0.78484035, 0.78583682, 0.78683335, 0.78782976, 0.78882617, 0.78982264, 0.79081905, 0.79181546, 0.79281181, 0.79380822, 0.79480457, 0.79580098, 0.79679728, 0.79779363, 0.79878998, 0.79978627, 0.80078256, 0.80177885, 0.80277508, 0.80377144, 0.80476767, 0.8057639, 0.80676007, 0.8077563, 0.80875248, 0.80974877, 0.81074494, 0.81174105, 0.81273723, 0.81373334, 0.81472951, 0.81572562, 0.81672168, 0.81771773, 0.81871384, 0.8197099, 0.82070595, 0.821702, 0.82269794, 0.82369399, 0.82468998, 0.82568598, 0.82668191, 0.82767785, 0.82867378, 0.82966971, 0.83066565, 0.83166152, 0.83265734, 0.83365321, 0.83464903, 0.8356449, 0.83664072, 0.83763647, 0.83863235, 0.8396281, 0.8406238, 0.84161961, 0.84261531, 0.843611, 0.8446067, 0.84560233, 0.84659803, 0.84759367, 0.8485893, 0.84958488, 0.85058051, 0.85157609, 0.85257167, 0.85356718, 0.85456276, 0.85555828, 0.85655373, 0.85754919, 0.85854465, 0.8595401, 0.8605355, 0.86153096, 0.8625263, 0.8635217, 0.86451703, 0.86551243, 0.86650771, 0.86750305, 0.86849833, 0.8694936, 0.87048888, 0.87148404, 0.87247932, 0.87347454, 0.8744697, 0.8754648, 0.87645996, 0.87745512, 0.87845021, 0.87944531, 0.88044035, 0.88143545, 0.88243043, 0.88342547, 0.88442045, 0.88541538, 0.88641036, 0.88740528, 0.88840026, 0.88939512, 0.89038998, 0.89138484, 0.8923797, 0.8933745, 0.8943693, 0.89536405, 0.89635885, 0.89735353, 0.89834827, 0.89934295, 0.9003377, 0.90133232, 0.90232694, 0.90332156, 0.90431619, 0.90531075, 0.90630525, 0.90729988, 0.90829438, 0.90928888, 0.91028333, 0.91127777, 0.91227221, 0.9132666, 0.91426098, 0.91525537, 0.91624975, 0.91724402, 0.91823834, 0.91923261, 0.92022693, 0.9212212, 0.92221534, 0.92320955, 0.92420369, 0.9251979, 0.92619205, 0.92718613, 0.92818028, 0.9291743, 0.93016839, 0.93116242, 0.93215638, 0.93315041, 0.93414438, 0.93513829, 0.93613219, 0.93712616, 0.93812001, 0.93911386, 0.9401077, 0.94110149, 0.94209528, 0.94308907, 0.9440828, 0.94507653, 0.94607025, 0.94706392, 0.94805765, 0.94905126, 0.95004493, 0.95103848, 0.95203209, 0.95302564, 0.95401919, 0.95501268, 0.95600617, 0.95699966, 0.95799309, 0.95898658, 0.95997995, 0.96097338, 0.96196669, 0.96296012, 0.96395344, 0.96494669, 0.96594, 0.96693325, 0.9679265, 0.96891975, 0.96991295, 0.97090614, 0.97189933, 0.97289246, 0.9738856, 0.97487873, 0.9758718, 0.97686487, 0.97785795, 0.97885096, 0.97984397, 0.98083699, 0.98182994, 0.9828229, 0.98381585, 0.98480874, 0.98580164, 0.98679453, 0.98778743, 0.98878026, 0.98977304, 0.99076587, 0.9917587, 0.99275142, 0.99374419, 0.99473697, 0.99572968, 0.9967224, 0.99771512, 0.99870777, 0.99970198,
            2.5994925e-05, 0.0001467769, 0.00040242536, 0.00077875017, 0.0012550969, 0.00181183, 0.0024321687, 0.003102927, 0.0038138554, 0.0045566717, 0.0053248685, 0.0061140661, 0.0069233398, 0.0077505424, 0.0085937679, 0.0094515951, 0.010322568, 0.011204826, 0.012096233, 0.012995231, 0.013900413, 0.014810755, 0.015725728, 0.016645053, 0.017568476, 0.018495746, 0.019426629, 0.020360908, 0.021298377, 0.022238849, 0.023182493, 0.024128756, 0.025077162, 0.026027914, 0.026980868, 0.027935868, 0.028892785, 0.029851479, 0.030811822, 0.031773958, 0.032737464, 0.033701792, 0.034667026, 0.035633244, 0.036600504, 0.037568837, 0.038538285, 0.039508853, 0.040480521, 0.041453257, 0.042427011, 0.043401711, 0.044377282, 0.045353666, 0.046330791, 0.047308601, 0.048287045, 0.049266081, 0.05024568, 0.051225808, 0.052206434, 0.053187553, 0.054169156, 0.055151224, 0.056133758, 0.057116747, 0.058100179, 0.059084043, 0.060068324, 0.061053012, 0.06203809, 0.063023552, 0.064009368, 0.064995542, 0.065982044, 0.066968873, 0.067956008, 0.068943448, 0.069931172, 0.070919178, 0.071907461, 0.072896004, 0.0738848, 0.07487385, 0.075863138, 0.076852657, 0.077842414, 0.07883238, 0.079822578, 0.080812983, 0.08180359, 0.082794398, 0.083785407, 0.084776588, 0.085767969, 0.086759523, 0.087751247, 0.088743143, 0.089735202, 0.090727419, 0.091719799, 0.092712328, 0.093705006, 0.094697833, 0.095690794, 0.09668389, 0.097677127, 0.098670498, 0.099663995, 0.10065762, 0.10165136, 0.10264523, 0.10363921, 0.1046333, 0.1056275, 0.10662182, 0.10761624, 0.10861076, 0.10960539, 0.11060012, 0.11159494, 0.11258986, 0.11358487, 0.11457998, 0.11557517, 0.11657045, 0.11756582, 0.11856126, 0.11955679, 0.12055241, 0.12154809, 0.12254386, 0.12353971, 0.12453563, 0.12553161, 0.12652767, 0.12752381, 0.12852, 0.12951626, 0.1305126, 0.13150899, 0.13250545, 0.13350196, 0.13449855, 0.13549519, 0.13649189, 0.13748865, 0.13848545, 0.13948232, 0.14047924, 0.1414762, 0.14247324, 0.14347032, 0.14446744, 0.1454646, 0.14646183, 0.1474591, 0.14845642, 0.14945379, 0.15045118, 0.15144864, 0.15244612, 0.15344366, 0.15444124, 0.15543887, 0.15643653, 0.15743423, 0.15843196, 0.15942973, 0.16042756, 0.1614254, 0.16242328, 0.16342121, 0.16441916, 0.16541716, 0.16641517, 0.16741323, 0.16841131, 0.16940945, 0.17040761, 0.17140579, 0.17240401, 0.17340225, 0.17440052, 0.17539881, 0.17639714, 0.17739551, 0.17839387, 0.17939229, 0.18039072, 0.18138918, 0.18238766, 0.18338618, 0.18438473, 0.18538329, 0.18638188, 0.18738048, 0.18837911, 0.18937775, 0.19037642, 0.19137512, 0.19237384, 0.19337258, 0.19437133, 0.19537009, 0.1963689, 0.19736773, 0.19836655, 0.19936541, 0.20036429, 0.20136316, 0.20236206, 0.20336099, 0.20435993, 0.20535889, 0.20635787, 0.20735686, 0.20835584, 0.20935488, 0.21035391, 0.21135297, 0.21235202, 0.2133511, 0.21435019, 0.2153493, 0.21634841, 0.21734753, 0.21834669, 0.21934585, 0.22034501, 0.22134419, 0.22234337, 0.22334258, 0.22434181, 0.22534102, 0.22634026, 0.22733951, 0.22833876, 0.22933802, 0.23033729, 0.23133658, 0.23233587, 0.23333518, 0.23433448, 0.2353338, 0.23633312, 0.23733248, 0.23833182, 0.23933116, 0.24033052, 0.24132989, 0.24232927, 0.24332863, 0.24432802, 0.24532741, 0.2463268, 0.24732623, 0.24832563, 0.24932505, 0.25032446, 0.25132388, 0.25232333, 0.25332278, 0.25432223, 0.25532165, 0.2563211, 0.25732055, 0.25832, 0.25931945, 0.26031891, 0.26131842, 0.26231787, 0.26331738, 0.26431683, 0.26531631, 0.26631579, 0.26731527, 0.26831478, 0.26931429, 0.27031377, 0.27131325, 0.27231273, 0.27331224, 0.27431172, 0.27531123, 0.27631074, 0.27731025, 0.27830976, 0.27930924, 0.28030875, 0.28130826, 0.28230777, 0.28330728, 0.28430676, 0.2853063, 0.28630581, 0.2873053, 0.28830481, 0.28930432, 0.29030383, 0.29130334, 0.29230282, 0.29330233, 0.29430184, 0.29530135, 0.29630083, 0.29730034, 0.29829982, 0.29929933, 0.30029878, 0.30129829, 0.30229777, 0.30329728, 0.30429676, 0.30529621, 0.30629569, 0.30729517, 0.30829465, 0.3092941, 0.31029359, 0.31129304, 0.31229252, 0.31329197, 0.31429145, 0.31529087, 0.31629032, 0.31728977, 0.31828919, 0.31928864, 0.32028806, 0.32128751, 0.32228693, 0.32328632, 0.32428575, 0.32528514, 0.32628459, 0.32728398, 0.32828337, 0.32928279, 0.33028215, 0.33128154, 0.33228093, 0.3332803, 0.33427966, 0.33527905, 0.33627841, 0.33727777, 0.33827713, 0.33927646, 0.34027579, 0.34127516, 0.34227449, 0.34327379, 0.34427312, 0.34527242, 0.34627172, 0.34727103, 0.34827033, 0.34926963, 0.35026893, 0.3512682, 0.35226747, 0.35326675, 0.35426602, 0.35526526, 0.3562645, 0.35726374, 0.35826296, 0.3592622, 0.36026141, 0.36126062, 0.36225984, 0.36325905, 0.36425823, 0.36525741, 0.36625662, 0.36725578, 0.36825496, 0.36925411, 0.37025329, 0.37125242, 0.37225157, 0.37325069, 0.37424982, 0.37524894, 0.37624806, 0.37724715, 0.37824625, 0.37924537, 0.38024443, 0.3812435, 0.38224256, 0.38324162, 0.38424069, 0.38523975, 0.38623878, 0.38723785, 0.38823685, 0.38923585, 0.39023489, 0.39123386, 0.39223287, 0.39323184, 0.39423084, 0.39522982, 0.39622876, 0.39722773, 0.39822668, 0.39922562, 0.40022454, 0.40122345, 0.40222239, 0.40322131, 0.40422019, 0.40521911, 0.40621799, 0.40721691, 0.40821573, 0.40921462, 0.41021347, 0.4112123, 0.41221115, 0.41320997, 0.4142088, 0.41520765, 0.41620645, 0.41720524, 0.41820404, 0.41920283, 0.4202016, 0.42120036, 0.42219913, 0.4231979, 0.42419666, 0.42519537, 0.4261941, 0.42719284, 0.42819157, 0.42919025, 0.43018895, 0.43118763, 0.43218634, 0.43318501, 0.43418369, 0.43518233, 0.43618098, 0.43717963, 0.43817827, 0.43917692, 0.44017553, 0.44117415, 0.44217274, 0.44317135, 0.44416994, 0.44516855, 0.44616708, 0.44716567, 0.44816422, 0.44916275, 0.45016131, 0.45115986, 0.45215839, 0.45315692, 0.45415545, 0.45515394, 0.45615244, 0.45715094, 0.4581494, 0.45914787, 0.46014634, 0.46114483, 0.46214327, 0.46314174, 0.46414015, 0.46513858, 0.46613702, 0.46713543, 0.46813384, 0.46913224, 0.47013062, 0.47112903, 0.47212741, 0.47312579, 0.47412413, 0.47512251, 0.47612086, 0.47711921, 0.47811753, 0.47911584, 0.48011416, 0.48111251, 0.48211083, 0.48310912, 0.48410743, 0.48510572, 0.48610398, 0.48710227, 0.48810053, 0.48909879, 0.49009702, 0.49109527, 0.49209353, 0.49309179, 0.49408999, 0.49508822, 0.49608642, 0.49708465, 0.49808282, 0.49908102, 0.50007921, 0.50107741, 0.50207555, 0.50307375, 0.50407189, 0.50507003, 0.50606823, 0.50706631, 0.50806451, 0.50906259, 0.51006073, 0.51105881, 0.51205695, 0.51305503, 0.51405317, 0.51505125, 0.51604933, 0.51704741, 0.51804549, 0.51904351, 0.52004158, 0.52103966, 0.52203768, 0.52303571, 0.52403378, 0.52503181, 0.52602983, 0.52702785, 0.52802581, 0.52902383, 0.53002185, 0.53101981, 0.53201783, 0.53301585, 0.53401381, 0.53501177, 0.53600973, 0.53700769, 0.53800565, 0.53900355, 0.54000151, 0.54099941, 0.54199737, 0.54299533, 0.54399323, 0.54499114, 0.54598904, 0.54698694, 0.54798484, 0.54898274, 0.54998064, 0.55097848, 0.55197638, 0.55297428, 0.55397213, 0.55496997, 0.55596787, 0.55696571, 0.55796355, 0.55896133, 0.55995923, 0.56095707, 0.56195486, 0.5629527, 0.56395048, 0.56494832, 0.5659461, 0.56694388, 0.56794173, 0.56893951, 0.56993729, 0.57093507, 0.57193279, 0.57293063, 0.57392836, 0.57492608, 0.57592386, 0.57692164, 0.57791936, 0.57891715, 0.57991487, 0.58091259, 0.58191025, 0.58290797, 0.58390576, 0.58490348, 0.58590114, 0.58689886, 0.58789653, 0.58889425, 0.58989191, 0.59088963, 0.5918873, 0.59288496, 0.59388262, 0.59488028, 0.59587795, 0.59687561, 0.59787327, 0.59887093, 0.59986854, 0.6008662, 0.60186386, 0.60286146, 0.60385913, 0.60485673, 0.60585427, 0.60685194, 0.60784954, 0.60884714, 0.60984474, 0.61084229, 0.61183989, 0.61283749, 0.6138351, 0.61483264, 0.61583024, 0.61682779, 0.61782533, 0.61882293, 0.61982042, 0.62081802, 0.62181556, 0.62281311, 0.62381065, 0.62480813, 0.62580568, 0.62680316, 0.62780076, 0.62879819, 0.62979573, 0.63079321, 0.63179076, 0.63278824, 0.63378572, 0.63478321, 0.63578069, 0.63677818, 0.6377756, 0.63877308, 0.63977057, 0.64076799, 0.64176542, 0.64276296, 0.64376038, 0.64475781, 0.64575523, 0.64675272, 0.64775008, 0.6487475, 0.64974493, 0.65074235, 0.65173972, 0.6527372, 0.65373456, 0.65473199, 0.65572935, 0.65672672, 0.65772414, 0.65872151, 0.65971887, 0.66071624, 0.6617136, 0.66271096, 0.66370827, 0.66470563, 0.665703, 0.6667003, 0.66769767, 0.66869497, 0.66969228, 0.67068958, 0.67168689, 0.67268419, 0.67368156, 0.67467886, 0.67567611, 0.67667335, 0.67767066, 0.67866796, 0.67966521, 0.68066251, 0.68165976, 0.682657, 0.68365425, 0.68465155, 0.68564874, 0.68664598, 0.68764323, 0.68864042, 0.68963766, 0.69063485, 0.69163209, 0.69262928, 0.69362646, 0.69462365, 0.69562083, 0.69661802, 0.69761521, 0.69861233, 0.69960952, 0.7006067, 0.70160383, 0.70260096, 0.70359814, 0.70459521, 0.70559233, 0.70658952, 0.70758659, 0.70858371, 0.70958078, 0.71057796, 0.71157503, 0.7125721, 0.71356916, 0.71456623, 0.7155633, 0.71656036, 0.71755743, 0.71855444, 0.7195515, 0.72054851, 0.72154552, 0.72254252, 0.72353959, 0.7245366, 0.72553355, 0.72653055, 0.72752756, 0.72852451, 0.72952145, 0.73051846, 0.73151541, 0.73251235, 0.7335093, 0.73450619, 0.73550314, 0.73650008, 0.73749697, 0.73849386, 0.73949075, 0.74048769, 0.74148452, 0.74248141, 0.7434783, 0.74447513, 0.74547195, 0.74646878, 0.74746567, 0.74846244, 0.74945933, 0.75045609, 0.75145292, 0.75244969, 0.75344652, 0.75444323, 0.75544, 0.75643677, 0.75743347, 0.75843024, 0.75942701, 0.76042372, 0.76142037, 0.76241708, 0.76341385, 0.7644105, 0.7654072, 0.76640385, 0.7674005, 0.76839715, 0.76939374, 0.77039039, 0.77138698, 0.77238363, 0.77338022, 0.77437681, 0.7753734, 0.77636993, 0.77736652, 0.77836311, 0.77935964, 0.78035617, 0.78135264, 0.78234917, 0.7833457, 0.78434217, 0.78533858, 0.78633511, 0.78733158, 0.78832799, 0.7893244, 0.79032087, 0.79131728, 0.79231369, 0.79331005, 0.79430646, 0.79530281, 0.79629916, 0.79729545, 0.7982918, 0.79928815, 0.80028445, 0.80128068, 0.80227703, 0.80327326, 0.80426955, 0.80526578, 0.80626202, 0.80725825, 0.80825442, 0.80925065, 0.81024683, 0.811243, 0.81223911, 0.81323528, 0.8142314, 0.81522757, 0.81622362, 0.81721973, 0.81821585, 0.8192119, 0.82020795, 0.82120395, 0.8222, 0.82319599, 0.82419205, 0.82518798, 0.82618397, 0.82717991, 0.82817584, 0.82917178, 0.83016765, 0.83116359, 0.83215946, 0.83315533, 0.83415115, 0.83514702, 0.83614284, 0.83713859, 0.83813447, 0.83913022, 0.84012598, 0.84112167, 0.84211749, 0.84311318, 0.84410888, 0.84510452, 0.84610021, 0.84709585, 0.84809148, 0.84908712, 0.8500827, 0.85107833, 0.85207391, 0.85306942, 0.854065, 0.85506052, 0.85605597, 0.85705149, 0.85804695, 0.85904241, 0.8600378, 0.86103326, 0.86202866, 0.863024, 0.86401939, 0.86501473, 0.86601013, 0.86700541, 0.86800075, 0.86899596, 0.86999124, 0.87098652, 0.87198168, 0.8729769, 0.87397212, 0.87496728, 0.87596244, 0.87695754, 0.87795264, 0.87894773, 0.87994283, 0.88093787, 0.88193291, 0.88292795, 0.88392293, 0.88491791, 0.8859129, 0.88690788, 0.88790274, 0.88889766, 0.88989258, 0.89088744, 0.89188224, 0.8928771, 0.89387196, 0.8948667, 0.89586151, 0.89685619, 0.89785093, 0.89884561, 0.8998403, 0.90083504, 0.90182966, 0.90282428, 0.90381891, 0.90481347, 0.90580803, 0.90680254, 0.90779716, 0.90879166, 0.90978611, 0.91078055, 0.91177499, 0.91276944, 0.91376382, 0.91475821, 0.91575259, 0.91674691, 0.91774118, 0.9187355, 0.91972977, 0.92072409, 0.92171824, 0.92271245, 0.92370665, 0.9247008, 0.925695, 0.92668909, 0.92768323, 0.92867726, 0.92967135, 0.93066537, 0.93165946, 0.93265343, 0.93364739, 0.93464136, 0.93563527, 0.93662918, 0.93762308, 0.93861693, 0.93961084, 0.94060463, 0.94159842, 0.9425922, 0.94358599, 0.94457972, 0.94557345, 0.94656712, 0.94756085, 0.94855446, 0.94954807, 0.95054173, 0.95153534, 0.95252889, 0.95352238, 0.95451593, 0.95550948, 0.95650291, 0.9574964, 0.95848984, 0.95948327, 0.96047664, 0.96147007, 0.96246338, 0.96345681, 0.96445006, 0.96544337, 0.96643662, 0.96742988, 0.96842313, 0.96941638, 0.97040957, 0.97140276, 0.9723959, 0.97338903, 0.97438216, 0.97537529, 0.97636837, 0.97736144, 0.97835445, 0.97934747, 0.98034048, 0.98133349, 0.98232645, 0.9833194, 0.9843123, 0.98530519, 0.98629808, 0.98729098, 0.98828387, 0.98927665, 0.99026948, 0.99126232, 0.99225509, 0.99324781, 0.99424058, 0.99523336, 0.99622607, 0.99721879, 0.99821144, 0.99920487]
abaqus_y = [-1.0000007e-36, 0.00099675823, 0.001977402, 0.0029237878, 0.0038256838, 0.0046793679, 0.0054855328, 0.006247025, 0.0069686389, 0.0076544033, 0.0083085792, 0.0089352923, 0.0095358156, 0.010110411, 0.010659061, 0.011183372, 0.011684783, 0.01216542, 0.012626809, 0.013071238, 0.013501175, 0.013919141, 0.014326523, 0.014723703, 0.015111019, 0.015488792, 0.015857335, 0.016216945, 0.01656791, 0.016910518, 0.017245036, 0.017571967, 0.017891096, 0.018202944, 0.018507794, 0.018805934, 0.019097658, 0.019383272, 0.019663075, 0.019937377, 0.020206641, 0.020470865, 0.020730386, 0.020985369, 0.02123596, 0.021482294, 0.021724502, 0.021962706, 0.022197023, 0.022427564, 0.022654438, 0.022877742, 0.023097575, 0.023314014, 0.023527136, 0.023737017, 0.023943735, 0.024147373, 0.024348013, 0.02454574, 0.02474064, 0.0249328, 0.025122304, 0.02530922, 0.025493599, 0.025675494, 0.025854958, 0.026032038, 0.02620679, 0.026379265, 0.026549513, 0.026717583, 0.026883528, 0.02704739, 0.027209207, 0.027369017, 0.027526852, 0.027682753, 0.027836759, 0.027988899, 0.028139219, 0.028287753, 0.028434537, 0.028579606, 0.028722987, 0.028864708, 0.029004795, 0.029143274, 0.029280171, 0.029415514, 0.02954933, 0.029681643, 0.029812487, 0.029941877, 0.030069841, 0.0301964, 0.030321568, 0.030445371, 0.030567827, 0.030688955, 0.030808775, 0.03092731, 0.031044578, 0.0311606, 0.031275392, 0.031388968, 0.031501345, 0.031612542, 0.031722564, 0.03183144, 0.031939179, 0.032045793, 0.0321513, 0.03225572, 0.03235906, 0.032461338, 0.032562561, 0.032662742, 0.032761902, 0.032860037, 0.03295717, 0.033053312, 0.033148479, 0.033242673, 0.033335909, 0.033428203, 0.033519559, 0.033609986, 0.033699494, 0.033788096, 0.033875801, 0.033962619, 0.034048557, 0.034133624, 0.034217834, 0.034301192, 0.034383703, 0.034465384, 0.03454623, 0.03462626, 0.034705475, 0.034783885, 0.034861501, 0.034938328, 0.035014376, 0.035089642, 0.035164144, 0.035237886, 0.035310872, 0.035383109, 0.035454605, 0.035525359, 0.035595391, 0.0356647, 0.035733286, 0.035801165, 0.035868336, 0.03593481, 0.036000587, 0.036065675, 0.036130078, 0.036193803, 0.036256853, 0.036319233, 0.036380954, 0.036442015, 0.036502421, 0.036562182, 0.036621295, 0.036679767, 0.036737602, 0.036794808, 0.036851391, 0.036907345, 0.036962681, 0.037017409, 0.037071522, 0.037125032, 0.037177939, 0.037230246, 0.037281957, 0.037333079, 0.037383612, 0.037433561, 0.037482932, 0.037531726, 0.037579946, 0.0376276, 0.037674684, 0.037721206, 0.037767168, 0.037812576, 0.037857428, 0.037901729, 0.037945483, 0.037988693, 0.038031366, 0.038073495, 0.038115092, 0.038156159, 0.03819669, 0.038236696, 0.038276181, 0.03831514, 0.038353585, 0.038391512, 0.038428921, 0.038465828, 0.03850222, 0.038538106, 0.038573492, 0.038608376, 0.03864276, 0.038676653, 0.038710047, 0.038742948, 0.038775362, 0.038807292, 0.038838737, 0.038869694, 0.038900174, 0.038930178, 0.038959701, 0.038988754, 0.039017335, 0.039045446, 0.039073091, 0.039100263, 0.039126977, 0.039153233, 0.039179023, 0.039204359, 0.039229237, 0.039253663, 0.039277636, 0.039301161, 0.039324231, 0.039346863, 0.039369047, 0.039390787, 0.039412085, 0.039432947, 0.039453369, 0.039473355, 0.039492909, 0.039512027, 0.039530717, 0.039548978, 0.039566811, 0.039584223, 0.039601203, 0.039617766, 0.039633907, 0.039649628, 0.039664932, 0.039679822, 0.039694294, 0.039708354, 0.039722003, 0.039735243, 0.039748073, 0.039760493, 0.039772514, 0.039784126, 0.039795343, 0.039806154, 0.039816566, 0.039826579, 0.039836198, 0.039845418, 0.039854247, 0.039862689, 0.039870735, 0.039878387, 0.039885659, 0.039892543, 0.039899036, 0.039905149, 0.039910879, 0.039916229, 0.039921198, 0.039925791, 0.039930008, 0.039933845, 0.03993731, 0.039940402, 0.039943121, 0.039945468, 0.03994745, 0.039949063, 0.039950307, 0.03995119, 0.039951704, 0.039951861, 0.039951652, 0.03995109, 0.039950162, 0.039948877, 0.039947242, 0.039945245, 0.039942898, 0.039940193, 0.039937146, 0.039933745, 0.039929993, 0.039925896, 0.039921451, 0.039916664, 0.039911531, 0.039906058, 0.03990024, 0.039894082, 0.039887588, 0.039880756, 0.039873589, 0.039866086, 0.039858244, 0.039850075, 0.039841574, 0.039832741, 0.039823577, 0.039814088, 0.039804272, 0.039794128, 0.039783664, 0.039772872, 0.039761763, 0.03975033, 0.039738581, 0.039726507, 0.03971412, 0.039701417, 0.039688397, 0.039675064, 0.039661422, 0.039647467, 0.0396332, 0.039618626, 0.039603744, 0.039588552, 0.039573055, 0.03955726, 0.039541155, 0.039524753, 0.039508048, 0.039491042, 0.039473735, 0.039456137, 0.03943824, 0.039420046, 0.039401561, 0.039382782, 0.039363712, 0.039344352, 0.039324701, 0.039304763, 0.039284538, 0.039264027, 0.039243232, 0.039222155, 0.03920079, 0.039179146, 0.039157227, 0.039135024, 0.039112546, 0.039089791, 0.039066754, 0.039043449, 0.039019875, 0.038996022, 0.038971901, 0.038947508, 0.038922846, 0.03889792, 0.038872723, 0.038847264, 0.038821541, 0.038795549, 0.038769301, 0.038742792, 0.038716022, 0.038688995, 0.038661711, 0.03863417, 0.038606372, 0.038578324, 0.038550019, 0.038521465, 0.038492657, 0.038463604, 0.038434301, 0.038404748, 0.038374949, 0.038344909, 0.038314622, 0.038284093, 0.038253322, 0.038222309, 0.038191061, 0.038159572, 0.038127843, 0.03809588, 0.038063683, 0.038031254, 0.037998587, 0.037965689, 0.037932564, 0.037899207, 0.03786562, 0.037831809, 0.037797771, 0.037763506, 0.037729017, 0.037694309, 0.037659377, 0.037624225, 0.03758885, 0.037553258, 0.037517447, 0.037481423, 0.03744518, 0.037408724, 0.037372056, 0.037335176, 0.037298083, 0.037260782, 0.037223268, 0.03718555, 0.037147626, 0.037109494, 0.037071157, 0.037032615, 0.036993876, 0.036954936, 0.03691579, 0.036876444, 0.0368369, 0.036797162, 0.036757227, 0.036717094, 0.036676772, 0.036636252, 0.036595546, 0.036554642, 0.036513548, 0.036472272, 0.036430802, 0.036389146, 0.036347307, 0.036305282, 0.036263071, 0.036220681, 0.036178105, 0.036135349, 0.036092415, 0.036049299, 0.036006011, 0.035962541, 0.035918895, 0.035875078, 0.035831086, 0.035786919, 0.035742581, 0.035698075, 0.035653394, 0.035608549, 0.035563532, 0.035518352, 0.035473004, 0.035427492, 0.035381813, 0.035335973, 0.035289973, 0.035243809, 0.035197485, 0.035151001, 0.035104364, 0.035057563, 0.03501061, 0.034963496, 0.034916233, 0.034868818, 0.034821246, 0.034773525, 0.034725647, 0.034677625, 0.034629449, 0.034581129, 0.034532662, 0.034484044, 0.034435283, 0.034386382, 0.034337334, 0.034288142, 0.034238808, 0.034189332, 0.034139719, 0.034089968, 0.034040075, 0.033990044, 0.033939879, 0.033889573, 0.03383914, 0.033788566, 0.033737861, 0.033687022, 0.033636056, 0.033584956, 0.033533726, 0.033482365, 0.033430878, 0.03337926, 0.03332752, 0.033275649, 0.033223659, 0.033171542, 0.033119299, 0.033066936, 0.033014446, 0.032961842, 0.032909114, 0.032856263, 0.032803297, 0.032750212, 0.032697011, 0.032643691, 0.032590251, 0.032536704, 0.032483038, 0.032429259, 0.032375365, 0.032321356, 0.032267243, 0.032213017, 0.03215868, 0.032104228, 0.032049675, 0.031995006, 0.031940233, 0.031885356, 0.031830367, 0.031775277, 0.031720083, 0.031664781, 0.031609379, 0.031553872, 0.031498261, 0.031442549, 0.031386737, 0.031330824, 0.03127481, 0.0312187, 0.031162487, 0.031106176, 0.031049773, 0.030993268, 0.030936668, 0.030879973, 0.03082318, 0.030766295, 0.030709315, 0.030652244, 0.030595075, 0.030537816, 0.030480469, 0.030423027, 0.030365491, 0.030307867, 0.030250154, 0.030192351, 0.030134462, 0.03007648, 0.030018412, 0.029960254, 0.029902015, 0.029843682, 0.02978527, 0.02972677, 0.029668184, 0.029609513, 0.029550757, 0.029491918, 0.029432995, 0.029373989, 0.029314902, 0.029255733, 0.029196478, 0.029137146, 0.029077731, 0.029018234, 0.028958658, 0.028899003, 0.02883927, 0.028779455, 0.028719559, 0.02865959, 0.028599538, 0.028539408, 0.028479202, 0.028418921, 0.028358558, 0.028298121, 0.028237607, 0.028177019, 0.028116353, 0.02805561, 0.027994797, 0.027933903, 0.027872937, 0.027811896, 0.027750781, 0.027689591, 0.027628327, 0.02756699, 0.027505578, 0.027444096, 0.02738254, 0.02732091, 0.027259208, 0.027197432, 0.027135585, 0.027073665, 0.027011674, 0.026949611, 0.026887475, 0.026825268, 0.026762988, 0.02670064, 0.026638217, 0.026575726, 0.026513165, 0.02645053, 0.026387824, 0.026325049, 0.026262203, 0.026199285, 0.026136298, 0.02607324, 0.026010111, 0.025946911, 0.025883643, 0.025820302, 0.025756892, 0.025693411, 0.025629861, 0.025566239, 0.025502548, 0.025438787, 0.025374953, 0.025311051, 0.025247077, 0.025183033, 0.025118919, 0.025054734, 0.024990479, 0.024926152, 0.024861755, 0.024797287, 0.024732748, 0.024668138, 0.024603456, 0.024538703, 0.024473879, 0.024408985, 0.024344018, 0.024278978, 0.024213869, 0.024148686, 0.02408343, 0.024018101, 0.023952702, 0.02388723, 0.023821684, 0.023756064, 0.023690373, 0.023624605, 0.023558768, 0.023492852, 0.023426866, 0.023360804, 0.023294665, 0.023228455, 0.023162168, 0.023095807, 0.023029368, 0.022962853, 0.022896264, 0.022829598, 0.022762856, 0.022696035, 0.022629136, 0.022562161, 0.02249511, 0.022427978, 0.022360766, 0.022293478, 0.02222611, 0.022158664, 0.022091135, 0.022023527, 0.021955838, 0.021888068, 0.021820217, 0.021752285, 0.021684268, 0.021616172, 0.02154799, 0.021479728, 0.02141138, 0.021342948, 0.021274431, 0.021205829, 0.021137143, 0.021068368, 0.020999512, 0.020930564, 0.020861531, 0.02079241, 0.020723199, 0.020653903, 0.020584516, 0.020515041, 0.020445473, 0.020375816, 0.020306068, 0.02023623, 0.020166297, 0.020096274, 0.020026157, 0.019955944, 0.019885641, 0.019815242, 0.019744746, 0.019674156, 0.019603467, 0.019532686, 0.019461805, 0.019390825, 0.019319747, 0.019248571, 0.019177295, 0.019105919, 0.019034442, 0.018962862, 0.018891182, 0.018819399, 0.018747512, 0.018675523, 0.018603427, 0.018531227, 0.018458921, 0.018386509, 0.018313993, 0.018241366, 0.018168632, 0.018095789, 0.018022837, 0.017949775, 0.017876603, 0.017803317, 0.017729923, 0.017656414, 0.017582791, 0.017509054, 0.017435204, 0.017361237, 0.017287156, 0.017212957, 0.017138641, 0.017064206, 0.016989652, 0.01691498, 0.016840188, 0.016765274, 0.016690239, 0.016615082, 0.016539803, 0.016464399, 0.016388871, 0.016313219, 0.016237441, 0.016161535, 0.016085504, 0.016009342, 0.015933054, 0.015856637, 0.015780089, 0.01570341, 0.0156266, 0.015549657, 0.015472583, 0.015395374, 0.01531803, 0.015240552, 0.015162937, 0.015085185, 0.015007298, 0.014929271, 0.014851105, 0.014772802, 0.014694356, 0.014615769, 0.014537042, 0.014458172, 0.014379157, 0.014300001, 0.014220697, 0.014141249, 0.014061654, 0.013981914, 0.013902023, 0.013821987, 0.013741801, 0.013661464, 0.013580976, 0.013500337, 0.013419546, 0.013338604, 0.013257506, 0.013176253, 0.013094845, 0.013013284, 0.012931564, 0.012849687, 0.012767652, 0.012685458, 0.012603104, 0.012520592, 0.012437917, 0.01235508, 0.01227208, 0.012188921, 0.012105593, 0.012022104, 0.011938448, 0.011854627, 0.011770638, 0.011686482, 0.011602159, 0.011517666, 0.011433003, 0.011348171, 0.011263167, 0.011177992, 0.011092645, 0.011007125, 0.010921431, 0.010835563, 0.010749519, 0.0106633, 0.010576905, 0.010490333, 0.010403583, 0.010316654, 0.010229548, 0.010142261, 0.010054794, 0.0099671464, 0.0098793171, 0.0097913062, 0.0097031128, 0.009614734, 0.0095261736, 0.0094374279, 0.0093484977, 0.0092593804, 0.0091700777, 0.0090805888, 0.0089909118, 0.0089010475, 0.0088109933, 0.0087207509, 0.0086303186, 0.0085396972, 0.008448883, 0.0083578797, 0.0082666827, 0.0081752948, 0.0080837142, 0.0079919398, 0.0078999717, 0.0078078089, 0.0077154529, 0.0076229, 0.0075301519, 0.0074372087, 0.0073440685, 0.0072507318, 0.0071571968, 0.0070634647, 0.0069695343, 0.0068754056, 0.0067810765, 0.0066865496, 0.0065918225, 0.006496896, 0.0064017684, 0.0063064396, 0.0062109111, 0.00611518, 0.0060192486, 0.0059231133, 0.0058267768, 0.0057302373, 0.0056334957, 0.0055365507, 0.005439403, 0.0053420509, 0.0052444949, 0.0051467363, 0.0050487723, 0.0049506039, 0.0048522311, 0.0047536539, 0.0046548713, 0.0045558838, 0.0044566919, 0.0043572951, 0.0042576925, 0.0041578836, 0.0040578702, 0.0039576506, 0.0038572261, 0.0037565958, 0.0036557599, 0.0035547183, 0.0034534712, 0.0033520181, 0.00325036, 0.0031484966, 0.0030464274, 0.0029441523, 0.0028416724, 0.0027389869, 0.0026360971, 0.0025330023, 0.002429703, 0.0023261989, 0.0022224907, 0.0021185782, 0.0020144617, 0.0019101411, 0.0018056177, 0.0017008906, 0.0015959612, 0.001490829, 0.0013854951, 0.0012799589, 0.0011742214, 0.0010682828, 0.00096214318, 0.00085580332, 0.00074926368, 0.00064252462, 0.00053558627, 0.00042844957, 0.00032111543, 0.00021358336, 0.00010585487, -2.0705959e-06, -0.00011019101, -0.00021850744, -0.00032701791, -0.00043572247, -0.0005446201, -0.00065370987, -0.00076299178, -0.00087246444, -0.00098212785, -0.00109198, -0.001202022, -0.0013122513, -0.001422668, -0.0015332712, -0.0016440598, -0.0017550328, -0.0018661886, -0.0019775268, -0.0020890469, -0.0022007476, -0.0023126274, -0.0024246862, -0.0025369227, -0.0026493354, -0.002761923, -0.0028746848, -0.00298762, -0.0031007268, -0.0032140047, -0.0033274521, -0.0034410679, -0.003554851, -0.0036688005, -0.003782914, -0.0038971903, -0.0040116278, -0.0041262247, -0.004240979, -0.0043558888, -0.0044709537, -0.0045861704, -0.004701538, -0.0048170555, -0.0049327216, -0.0050485353, -0.0051644966, -0.0052806041, -0.0053968579, -0.0055132564, -0.0056297989, -0.0057464857, -
            0.0058634719, 0.00050045457, 0.0014913739, 0.0024549733, 0.0033791035, 0.0042568366, 0.0050866967, 0.0058704773, 0.0066120257, 0.0073157558, 0.0079858257, 0.0086263325, 0.0092397407, 0.0098270532, 0.010388387, 0.010924559, 0.011437089, 0.011927769, 0.012398418, 0.012850956, 0.013287765, 0.013711384, 0.014124013, 0.01452627, 0.014918495, 0.015301017, 0.015674153, 0.016038207, 0.016393477, 0.016740244, 0.017078787, 0.017409494, 0.017732486, 0.018047936, 0.018356243, 0.018657697, 0.018952589, 0.019241218, 0.019523881, 0.019800894, 0.020072635, 0.020339338, 0.020601185, 0.020858424, 0.021111198, 0.021359649, 0.021603908, 0.0218441, 0.022080349, 0.022312764, 0.02254146, 0.022766534, 0.022988092, 0.023206217, 0.023420988, 0.023632476, 0.023840766, 0.024045933, 0.024248062, 0.024447234, 0.024643537, 0.024837054, 0.025027879, 0.025216082, 0.025401725, 0.025584854, 0.025765525, 0.025943791, 0.026119703, 0.026293309, 0.026464663, 0.026633816, 0.026800817, 0.026965717, 0.027128553, 0.027289361, 0.027448179, 0.027605044, 0.027759992, 0.02791306, 0.028064286, 0.028213708, 0.028361361, 0.028507283, 0.028651506, 0.028794054, 0.028934954, 0.029074233, 0.029211918, 0.029348034, 0.029482611, 0.029615672, 0.029747248, 0.029877363, 0.030006038, 0.030133296, 0.030259157, 0.030383639, 0.030506767, 0.030628556, 0.030749027, 0.030868202, 0.0309861, 0.031102743, 0.031218149, 0.031332329, 0.031445306, 0.031557091, 0.031667698, 0.031777147, 0.031885449, 0.031992625, 0.032098684, 0.032203645, 0.032307524, 0.032410331, 0.032512084, 0.032612782, 0.032712448, 0.032811094, 0.03290873, 0.033005368, 0.033101015, 0.033195693, 0.03328941, 0.033382174, 0.033473998, 0.033564888, 0.033654854, 0.03374391, 0.033832062, 0.03391932, 0.034005698, 0.034091197, 0.034175836, 0.034259617, 0.03434255, 0.034424648, 0.034505907, 0.034586348, 0.034665968, 0.034744781, 0.034822792, 0.03490001, 0.034976449, 0.035052102, 0.035126992, 0.03520111, 0.035274472, 0.035347085, 0.035418946, 0.035490073, 0.035560466, 0.035630137, 0.035699081, 0.035767313, 0.035834841, 0.035901658, 0.035967786, 0.036033217, 0.036097962, 0.036162026, 0.036225412, 0.036288127, 0.036350176, 0.036411569, 0.036472302, 0.036532383, 0.036591817, 0.036650609, 0.036708765, 0.036766287, 0.036823176, 0.036879443, 0.036935091, 0.036990121, 0.03704454, 0.037098352, 0.03715156, 0.037204165, 0.037256174, 0.037307594, 0.037358418, 0.037408657, 0.037458319, 0.0375074, 0.037555911, 0.037603844, 0.037651211, 0.037698016, 0.037744258, 0.037789941, 0.037835069, 0.037879646, 0.037923675, 0.037967157, 0.038010098, 0.038052499, 0.03809436, 0.038135689, 0.038176488, 0.038216759, 0.038256504, 0.038295723, 0.038334426, 0.03837261, 0.03841028, 0.03844744, 0.038484089, 0.038520228, 0.038555864, 0.038590997, 0.038625631, 0.038659766, 0.038693409, 0.038726557, 0.03875922, 0.038791388, 0.038823072, 0.038854275, 0.038884997, 0.038915236, 0.038944997, 0.038974289, 0.039003104, 0.03903145, 0.039059326, 0.039086733, 0.039113682, 0.039140161, 0.039166186, 0.039191749, 0.039216854, 0.039241508, 0.039265703, 0.039289452, 0.03931275, 0.039335605, 0.039358009, 0.039379969, 0.03940149, 0.039422568, 0.03944321, 0.039463416, 0.039483186, 0.03950252, 0.039521426, 0.039539903, 0.039557952, 0.039575569, 0.039592765, 0.03960954, 0.039625887, 0.03964182, 0.039657332, 0.039672427, 0.039687108, 0.039701372, 0.03971523, 0.039728671, 0.039741706, 0.039754335, 0.039766554, 0.039778374, 0.039789785, 0.0398008, 0.03981141, 0.039821625, 0.039831437, 0.039840858, 0.039849885, 0.039858516, 0.03986676, 0.03987461, 0.039882071, 0.039889149, 0.039895836, 0.039902143, 0.039908063, 0.039913602, 0.039918762, 0.039923541, 0.039927945, 0.039931972, 0.039935622, 0.039938901, 0.039941806, 0.03994434, 0.039946504, 0.039948303, 0.03994973, 0.039950795, 0.039951492, 0.039951827, 0.039951801, 0.039951414, 0.039950665, 0.039949566, 0.039948102, 0.039946288, 0.039944112, 0.03994159, 0.039938714, 0.039935488, 0.039931912, 0.039927989, 0.039923716, 0.039919101, 0.039914139, 0.039908838, 0.03990319, 0.039897207, 0.039890878, 0.039884217, 0.039877214, 0.039869878, 0.039862204, 0.039854202, 0.039845865, 0.039837196, 0.0398282, 0.039818875, 0.03980922, 0.039799243, 0.039788935, 0.039778311, 0.039767358, 0.039756086, 0.039744496, 0.039732583, 0.039720356, 0.039707806, 0.03969495, 0.03968177, 0.039668281, 0.039654486, 0.039640374, 0.039625954, 0.039611224, 0.039596185, 0.039580841, 0.039565194, 0.039549243, 0.039532989, 0.039516438, 0.039499581, 0.039482426, 0.039464973, 0.039447226, 0.039429177, 0.039410841, 0.039392207, 0.039373282, 0.039354067, 0.039334562, 0.039314769, 0.039294686, 0.03927432, 0.039253663, 0.039232727, 0.039211504, 0.039190006, 0.039168224, 0.039146159, 0.039123822, 0.039101202, 0.039078306, 0.039055139, 0.039031696, 0.03900798, 0.038983997, 0.038959734, 0.038935211, 0.038910415, 0.038885355, 0.038860027, 0.038834434, 0.038808577, 0.038782462, 0.03875608, 0.038729444, 0.03870254, 0.038675386, 0.038647972, 0.038620304, 0.03859238, 0.038564201, 0.038535774, 0.038507089, 0.038478158, 0.038448982, 0.038419552, 0.03838988, 0.038359959, 0.038329795, 0.038299385, 0.038268737, 0.038237844, 0.038206715, 0.038175344, 0.038143735, 0.038111892, 0.038079809, 0.038047496, 0.038014948, 0.037982166, 0.037949156, 0.037915912, 0.037882444, 0.037848745, 0.037814818, 0.037780669, 0.037746292, 0.037711691, 0.037676871, 0.037641827, 0.037606563, 0.03757108, 0.037535381, 0.037499461, 0.037463326, 0.037426978, 0.037390418, 0.037353642, 0.037316658, 0.037279461, 0.037242055, 0.037204437, 0.037166614, 0.037128586, 0.037090354, 0.037051912, 0.037013274, 0.03697443, 0.036935382, 0.036896139, 0.0368567, 0.036817055, 0.036777221, 0.036737185, 0.036696959, 0.036656536, 0.036615923, 0.036575116, 0.036534119, 0.036492936, 0.03645156, 0.03641, 0.036368251, 0.036326315, 0.036284197, 0.036241896, 0.036199413, 0.036156751, 0.036113903, 0.03607088, 0.036027677, 0.035984296, 0.03594074, 0.035897009, 0.035853103, 0.035809021, 0.035764772, 0.035720348, 0.035675753, 0.035630994, 0.035586063, 0.035540964, 0.035495698, 0.035450269, 0.035404675, 0.035358913, 0.035312995, 0.03526691, 0.035220668, 0.035174266, 0.035127703, 0.035080981, 0.035034105, 0.034987073, 0.034939885, 0.034892544, 0.034845047, 0.0347974, 0.034749601, 0.034701657, 0.034653556, 0.034605306, 0.034556914, 0.034508374, 0.034459684, 0.034410853, 0.034361873, 0.034312755, 0.034263492, 0.034214087, 0.034164544, 0.03411486, 0.034065038, 0.034015078, 0.03396498, 0.033914745, 0.033864375, 0.033813868, 0.03376323, 0.033712462, 0.033661555, 0.033610523, 0.033559356, 0.033508062, 0.033456635, 0.033405084, 0.033353403, 0.033301603, 0.033249669, 0.033197612, 0.033145435, 0.033093132, 0.033040706, 0.032988157, 0.032935493, 0.032882705, 0.032829795, 0.032776769, 0.032723624, 0.032670364, 0.032616988, 0.032563493, 0.032509882, 0.03245616, 0.032402329, 0.032348376, 0.032294314, 0.032240141, 0.032185856, 0.032131467, 0.032076962, 0.032022353, 0.031967636, 0.031912807, 0.031857878, 0.031802841, 0.031747691, 0.031692445, 0.031637091, 0.031581637, 0.031526081, 0.031470418, 0.031414658, 0.03135879, 0.031302828, 0.031246766, 0.031190606, 0.031134343, 0.031077985, 0.031021534, 0.03096498, 0.030908329, 0.03085159, 0.030794749, 0.030737819, 0.030680792, 0.030623671, 0.030566458, 0.030509153, 0.030451758, 0.030394267, 0.030336691, 0.030279022, 0.030221265, 0.030163417, 0.030105483, 0.03004746, 0.029989347, 0.029931145, 0.029872861, 0.029814487, 0.029756028, 0.029697485, 0.029638855, 0.029580142, 0.029521346, 0.029462466, 0.029403502, 0.029344454, 0.029285327, 0.029226117, 0.029166821, 0.029107448, 0.029047994, 0.028988456, 0.028928842, 0.028869146, 0.028809372, 0.028749516, 0.028689584, 0.028629573, 0.028569482, 0.028509317, 0.028449072, 0.028388748, 0.028328348, 0.028267873, 0.028207323, 0.028146695, 0.028085992, 0.028025214, 0.027964357, 0.027903428, 0.027842425, 0.027781349, 0.027720196, 0.027658967, 0.027597668, 0.027536293, 0.027474847, 0.027413327, 0.027351733, 0.027290067, 0.027228329, 0.027166517, 0.027104635, 0.027042678, 0.026980652, 0.026918551, 0.026856378, 0.026794136, 0.026731825, 0.026669437, 0.026606983, 0.026544454, 0.026481854, 0.026419185, 0.026356444, 0.026293634, 0.026230754, 0.026167801, 0.026104776, 0.026041683, 0.025978521, 0.025915287, 0.025851982, 0.025788605, 0.02572516, 0.025661644, 0.025598058, 0.025534401, 0.025470674, 0.02540688, 0.02534301, 0.025279073, 0.025215065, 0.025150986, 0.025086835, 0.025022615, 0.024958324, 0.024893962, 0.024829529, 0.024765028, 0.024700452, 0.024635805, 0.024571089, 0.024506303, 0.024441442, 0.02437651, 0.024311505, 0.024246432, 0.024181286, 0.024116065, 0.024050774, 0.02398541, 0.023919974, 0.023854464, 0.023788882, 0.023723228, 0.023657499, 0.023591695, 0.023525819, 0.023459869, 0.023393843, 0.023327745, 0.023261568, 0.023195321, 0.023128998, 0.023062596, 0.022996118, 0.02292957, 0.022862943, 0.022796238, 0.022729455, 0.022662595, 0.022595659, 0.022528645, 0.022461552, 0.022394381, 0.022327133, 0.022259803, 0.022192396, 0.022124911, 0.022057343, 0.021989694, 0.021921964, 0.021854155, 0.021786261, 0.021718288, 0.021650231, 0.021582093, 0.02151387, 0.021445563, 0.021377174, 0.0213087, 0.021240139, 0.021171495, 0.021102764, 0.02103395, 0.020965049, 0.020896059, 0.02082698, 0.020757817, 0.020688564, 0.020619221, 0.020549787, 0.020480268, 0.020410657, 0.020340953, 0.02027116, 0.020201273, 0.020131296, 0.020061227, 0.019991064, 0.019920804, 0.019850453, 0.019780006, 0.019709466, 0.019638823, 0.019568088, 0.019497259, 0.019426327, 0.019355299, 0.019284172, 0.019212944, 0.019141618, 0.019070193, 0.018998664, 0.018927036, 0.018855304, 0.018783469, 0.01871153, 0.018639488, 0.01856734, 0.018495088, 0.018422728, 0.018350264, 0.018277692, 0.018205011, 0.018132225, 0.018059328, 0.01798632, 0.017913204, 0.017839974, 0.017766632, 0.017693181, 0.017619615, 0.017545937, 0.017472142, 0.017398234, 0.017324209, 0.01725007, 0.017175814, 0.017101437, 0.017026942, 0.016952332, 0.016877601, 0.016802747, 0.016727773, 0.016652675, 0.016577458, 0.016502116, 0.016426649, 0.016351061, 0.016275346, 0.016199505, 0.016123535, 0.016047439, 0.015971214, 0.015894862, 0.015818378, 0.015741765, 0.015665021, 0.015588143, 0.015511137, 0.015433996, 0.01535672, 0.015279308, 0.01520176, 0.015124078, 0.01504626, 0.014968301, 0.014890202, 0.01481197, 0.014733597, 0.01465508, 0.014576422, 0.014497624, 0.014418681, 0.014339596, 0.014260365, 0.014180992, 0.014101471, 0.014021803, 0.013941986, 0.013862024, 0.013781914, 0.013701651, 0.013621239, 0.013540674, 0.013459961, 0.013379094, 0.013298075, 0.0132169, 0.01313557, 0.013054083, 0.012972443, 0.012890647, 0.01280869, 0.012726576, 0.0126443, 0.012561869, 0.012479276, 0.012396518, 0.012313599, 0.012230521, 0.012147277, 0.012063868, 0.011980297, 0.011896556, 0.011812653, 0.011728581, 0.011644342, 0.011559932, 0.011475355, 0.011390607, 0.011305688, 0.0112206, 0.011135342, 0.011049908, 0.010964301, 0.010878518, 0.010792564, 0.010706431, 0.010620122, 0.01053364, 0.01044698, 0.010360139, 0.010273123, 0.010185925, 0.01009855, 0.010010993, 0.0099232532, 0.0098353326, 0.0097472314, 0.0096589457, 0.0095704747, 0.0094818212, 0.0093929851, 0.0093039619, 0.0092147505, 0.0091253547, 0.0090357736, 0.0089460053, 0.0088560442, 0.0087658959, 0.0086755594, 0.0085850321, 0.0084943157, 0.0084034074, 0.0083123054, 0.0082210125, 0.0081295287, 0.0080378503, 0.0079459809, 0.0078539141, 0.0077616554, 0.0076692025, 0.0075765499, 0.0074837022, 0.0073906635, 0.0072974255, 0.0072039897, 0.0071103573, 0.0070165247, 0.0069224951, 0.0068282653, 0.006733838, 0.0066392124, 0.0065443846, 0.0064493585, 0.0063541303, 0.0062587019, 0.0061630709, 0.0060672397, 0.0059712064, 0.0058749709, 0.0057785329, 0.0056818919, 0.0055850479, 0.0054880027, 0.0053907521, 0.0052932994, 0.0051956428, 0.0050977813, 0.0049997135, 0.0049014417, 0.0048029674, 0.0047042896, 0.0046054041, 0.0045063128, 0.0044070198, 0.0043075196, 0.0042078127, 0.0041079004, 0.0040077856, 0.0039074649, 0.0038069368, 0.0037062033, 0.0036052668, 0.0035041221, 0.0034027703, 0.0033012144, 0.0031994532, 0.0030974883, 0.0029953152, 0.0028929352, 0.0027903544, 0.0026875697, 0.0025845771, 0.0024813788, 0.0023779764, 0.002274371, 0.002170559, 0.0020665447, 0.0019623272, 0.001857904, 0.0017532784, 0.0016484512, 0.0015434192, 0.0014381864, 0.0013327523, 0.0012271146, 0.0011212764, 0.0010152385, 0.00090899778, 0.00080255826, 0.00069591991, 0.00058908027, 0.00048204316, 0.00037480865, 0.00026737485, 0.00015974554, 5.1916431e-05, -5.6107201e-05, -0.00016432491, -0.00027274003, -0.00038134822, -0.00049014809, -0.00059914018, -0.00070832676, -0.00081770361, -0.00092727254, -0.0010370302, -0.001146977, -0.0012571133, -0.0013674365, -0.0014779454, -0.0015886419, -0.0016995256, -0.0018105883, -0.001921833, -0.0020332616, -0.0021448731, -0.002256664, -0.0023686322, -0.0024807805, -0.002593108, -0.0027056097, -0.002818282, -0.0029311294, -0.0030441519, -0.0031573439, -0.0032707085, -0.0033842402, -0.0034979391, -0.0036118065, -0.0037258381, -0.0038400316, -0.0039543887, -0.0040689083, -0.0041835839, -0.0042984155, -0.004413404, -0.0045285448, -0.0046438356, -0.0047592781, -0.0048748711, -0.0049906112, -0.0051064971, -0.005222532, -0.0053387149, -0.0054550413, -0.0055715111, -0.0056881262, -0.0058049709]
rotated_abaqus = rotate({'x': abaqus_x, 'y': abaqus_y}, normalize=False)
abaqus_x = rotated_abaqus['x']
abaqus_y = rotated_abaqus['y']

# plt.figure()
# plt.plot(abaqus_x, abaqus_y, 'b')
# plt.plot(rotated_abaqus['x'], rotated_abaqus['y'], 'r')
# plt.show()

# NACA0008
# higher order [0.1194, 0.0976, 0.1231, 0.0719, 0.1061, 0.1089, 0]
# N 100: 0.06430238065609895
# N 10: 0.011485823192467997
g = CoordinateSystem.CST(D=[0.11397826, 0.10433884, 0.10241407, 0.10070566, 0.0836374,  0.11353368, 0], chord=1,
                         color='b', N1=.5, N2=1, tol=None)
g_p = CoordinateSystem.CST(D=[0.11397826, 0.10433884, 0.10241407, 0.10070566, 0.0836374,  0.11353368, 0], chord=1,
                           color='k', N1=.5, N2=1, tol=None)

# g.x1_grid = create_x(1, n=100, distribution='polar')[::-1]
# s = g_p.calculate_s(101, g.arclength(np.array([1]))[0], density='gradient')
s = g_p.calculate_s(101, density='curvature')
# y = g_p.x3(g_p.x1_grid)
# data = np.array([g_p.x1_grid, y]).T
# np.savetxt('airfoil_points.csv', data, delimiter=',')
# print(g_p.partial)
# BREAK
# g.calculate_x1(s)
# g_p.calculate_x1(s)
# g.x1_grid = g_p.x1_grid
# g.darc = g_p.darc
# print('x', g_p.x1_grid[-1])
# print('s', s[-1])
# g_p.calculate_x1(s)
# print('x', g_p.x1_grid)
# BREAK
print(s)
# s = np.linspace(0, g.arclength(1)[0], 100)
# print('x', g.x1_grid)
# g.calculate_x1(s)
rho = g_p.radius_curvature(g_p.x1_grid, output_only=True)
plt.figure()
plt.scatter(g_p.x1_grid, rho, c='b', label='calculate_s')
g_p.calculate_x1(s)
rho = g_p.radius_curvature(g_p.x1_grid, output_only=True)
print('x', g_p.x1_grid)
print('rho', rho)
plt.scatter(g_p.x1_grid, rho, c='r', label='calculate_x1')
plt.legend()
plt.show()
# BREAK
# g.darc = np.zeros(len(g.x1_grid))
# for i in range(len(g.x1_grid)):
#     print(i, g.improper_arclength_index(i), g.arclength(g.x1_grid[i])[0])
#
# BREAK
p = properties()
l = loads(concentrated_load=[[0, -1]], load_s=[s[-1]], follower=True)

b = beam_chen(g, p, l, s)
b.length = s[-1]
# b.g_p.calculate_x1(s)
# b.g.D = [0.11621803608468839, 0.11164077707202186,
#          0.08581012060178156, 0.11474758149621056, -0.005855939703725668]
# solution
# b.g.D = [0.11317106940637985, 0.10774051556264977, 0.09141493349219963, 0.10766720638192107, 0]
b.g.D = [0.11393863135878562, 0.11696225486582357, 0.06814132833709942, 0.10828109569350694, 0]
# fitted
# b.g.D = [0.11642915, 0.11141244, 0.08593644, 0.1146274, 0]
# D = format_input([0.11621803608468839, 0.11164077707202186,
#                   0.08581012060178156, 0.11474758149621056], g=b.g, g_p=b.g_p)
# b.g.D = [0.11621803608468839, 0.11164077707202186,
#          0.08581012060178156, 0.11474758149621056, -0.005855939703725668]
# print('D', D)
# b.D = D
# arc = []
# correct_arc = []
# Ns = np.linspace(100, 100000, 100)
# for N in Ns:


def test_function():
    b.g.internal_variables(b.length)
    b.g.calculate_x1(b.s)
    b.x = b.g.x1_grid
    b.y = b.g.x3(b.x)
    b._residual(b.g.D)


print('s', s == np.sort(s))
print('Accurate', b.length)
print('Improper (parent)', b.g_p.improper_arclength_chord(), b.g_p.chord)
test_function()
print('Improper (child)', b.g.improper_arclength_chord(), b.g.chord)
print('Residual', b.R, b.g.chord, b.g.arclength(b.g.chord)[0])


# b.parameterized_solver(format_input=format_input, x0=g.D[:-1])
# b.g.internal_variables(b.length)
# b.g.calculate_x1(b.s)
# b.x = b.g.x1_grid
# b.y = b.g.x3(b.x)


print('residual: ', b._residual(b.g.D))
# print('x', b.x)
# print('y', b.y)
# print('sizes', len(b.x), len(b.s))
# print('chord', b.g.chord)
g_p.calculate_x1(b.s)
print('x', b.g.x1_grid == np.sort(b.g.x1_grid))
plt.figure()
plt.plot(b.g.x1_grid, b.M/b.p.young/b.p.inertia, 'b', label='RHS (Moment)')
# plt.plot(b.g.x1_grid, b.g.rho - b.g_p.rho, 'r', label='LHS (Curvatures)')
plt.plot(b.g_p.x1_grid, b.g_p.rho, 'r', label='LHS (Curvatures)')
plt.scatter(b.g_p.x1_grid, b.g_p.rho, c='r')
plt.plot(b.g.x1_grid, b.g.rho, 'g', label='LHS (Curvatures)')
plt.scatter(b.g.x1_grid, b.g.rho, c='g')
plt.xlabel('x')
plt.ylabel('RHS/LHS')
plt.legend()
plt.figure()
g_p.plot(label='Parent')
print('chord', b.g.chord)
plt.plot(b.x, b.y, '.5', label='Child: %.3f N' % -l.concentrated_load[0][-1], lw=3)
plt.scatter(abaqus_x, abaqus_y, c='.5', label='FEA: %.3f N' % -
            l.concentrated_load[0][-1], edgecolors='k', zorder=10, marker="^")

plt.legend()
plt.show()
